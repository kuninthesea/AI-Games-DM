# TRPGè·‘å›¢æ¸¸æˆåŠ©æ‰‹ v2.0

ä¸€ä¸ªåŸºäºFlaskçš„TRPGï¼ˆæ¡Œé¢è§’è‰²æ‰®æ¼”æ¸¸æˆï¼‰åŠ©æ‰‹ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ã€‚

## é¡¹ç›®ç»“æ„

```
AIGame/
â”œâ”€â”€ backend/                 # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app.py              # ä¸»åº”ç”¨æ–‡ä»¶
â”‚   â”œâ”€â”€ config.py           # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ api_client.py       # AI APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ user_manager.py     # ç”¨æˆ·ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ history_manager.py  # å†å²è®°å½•ç®¡ç†æ¨¡å—
â”œâ”€â”€ frontend/               # å‰ç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app.py             # å‰ç«¯æœåŠ¡å™¨
â”‚   â”œâ”€â”€ templates/         # HTMLæ¨¡æ¿
â”‚   â”‚   â””â”€â”€ index.html     # ä¸»é¡µé¢
â”‚   â””â”€â”€ static/            # é™æ€èµ„æº
â”‚       â”œâ”€â”€ css/
â”‚       â”‚   â””â”€â”€ style.css  # æ ·å¼æ–‡ä»¶
â”‚       â””â”€â”€ js/
â”‚           â””â”€â”€ app.js     # åº”ç”¨é€»è¾‘
â”œâ”€â”€ history/               # èŠå¤©å†å²æ–‡ä»¶
â”œâ”€â”€ userdata/             # ç”¨æˆ·æ•°æ®æ–‡ä»¶
â”œâ”€â”€ image/                # è§’è‰²å›¾ç‰‡
â”œâ”€â”€ start.bat             # å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜
```

## åŠŸèƒ½ç‰¹æ€§

- ğŸ­ å¤šè§’è‰²AIå¯¹è¯ç³»ç»Ÿ
- ğŸ‘¤ ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç³»ç»Ÿ
- ğŸ“Š è§’è‰²æ•°æ®ç®¡ç† (HP/MP/é‡‘å¸)
- ğŸ’¬ èŠå¤©å†å²è®°å½•
- ğŸ–¼ï¸ è§’è‰²å›¾ç‰‡æ˜¾ç¤º
- ğŸ”„ æ¶ˆæ¯é‡æ–°ç”Ÿæˆå’Œç¼–è¾‘
- ğŸ’¾ æ•°æ®æŒä¹…åŒ–å­˜å‚¨

## å®‰è£…ä¾èµ–

```bash
pip install flask openai google-generativeai flask-cors
```

## å¯åŠ¨æ–¹å¼

### æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
åŒå‡»è¿è¡Œ `start.bat` æ–‡ä»¶

### æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨

1. å¯åŠ¨åç«¯æœåŠ¡å™¨ï¼š
```bash
cd backend
python app.py
```

2. å¯åŠ¨å‰ç«¯æœåŠ¡å™¨ï¼š
```bash
cd frontend
python app.py
```

## è®¿é—®åœ°å€

- å‰ç«¯ç•Œé¢: http://localhost:3000
- åç«¯API: http://localhost:5000

## é…ç½®è¯´æ˜

åœ¨ `backend/config.py` ä¸­é…ç½®æ‚¨çš„APIå¯†é’¥ï¼š

```python
OPENAI_API_KEY = "your-openai-api-key"
GEMINI_API_KEY = "your-gemini-api-key"
```

## APIæ¥å£

### ç”¨æˆ·ç®¡ç†
- `POST /login` - ç”¨æˆ·ç™»å½•
- `POST /register` - ç”¨æˆ·æ³¨å†Œ
- `POST /get_user_data` - è·å–ç”¨æˆ·æ•°æ®
- `POST /update_user_stats` - æ›´æ–°ç”¨æˆ·æ•°å€¼
- `POST /reset_user_data` - é‡ç½®ç”¨æˆ·æ•°æ®

### èŠå¤©åŠŸèƒ½
- `POST /chat` - å‘é€èŠå¤©æ¶ˆæ¯
- `POST /get_character_history` - è·å–è§’è‰²èŠå¤©å†å²
- `POST /clear` - æ¸…ç©ºèŠå¤©å†å²
- `POST /update_message` - æ›´æ–°æ¶ˆæ¯å†…å®¹

### å…¶ä»–
- `GET /get_characters` - è·å–å¯ç”¨è§’è‰²åˆ—è¡¨
- `GET /image/<filename>` - è·å–è§’è‰²å›¾ç‰‡

## æŠ€æœ¯æ ˆ

- **åç«¯**: Flask, Python
- **å‰ç«¯**: HTML5, CSS3, JavaScript (ES6+)
- **æ•°æ®å­˜å‚¨**: JSONæ–‡ä»¶
- **AIæœåŠ¡**: OpenAI GPT / Google Gemini

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°è§’è‰²

åœ¨ `backend/config.py` çš„ `game_prompts` å­—å…¸ä¸­æ·»åŠ æ–°è§’è‰²çš„æç¤ºè¯ã€‚

### è‡ªå®šä¹‰æ ·å¼

ä¿®æ”¹ `frontend/static/css/style.css` æ–‡ä»¶æ¥è°ƒæ•´ç•Œé¢æ ·å¼ã€‚

### æ‰©å±•åŠŸèƒ½

- åç«¯APIæ‰©å±•ï¼šåœ¨ `backend/app.py` ä¸­æ·»åŠ æ–°çš„è·¯ç”±
- å‰ç«¯åŠŸèƒ½æ‰©å±•ï¼šåœ¨ `frontend/static/js/app.js` ä¸­æ·»åŠ æ–°çš„JavaScriptå‡½æ•°

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿ä¸¤ä¸ªæœåŠ¡å™¨éƒ½æ­£å¸¸å¯åŠ¨
2. å‰ç«¯é»˜è®¤è¿æ¥åˆ° `localhost:5000` çš„åç«¯æœåŠ¡
3. ç”¨æˆ·æ•°æ®å’ŒèŠå¤©å†å²ä»¥JSONæ ¼å¼å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ä¸­
4. éœ€è¦æœ‰æ•ˆçš„AI APIå¯†é’¥æ‰èƒ½æ­£å¸¸ä½¿ç”¨èŠå¤©åŠŸèƒ½

## ç‰ˆæœ¬å†å²

- v2.0: å‰åç«¯åˆ†ç¦»æ¶æ„
- v1.0: å•ä½“åº”ç”¨æ¶æ„
